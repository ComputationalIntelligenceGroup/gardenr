---
output:
  md_document:
    variant: markdown_github
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

## gardenr 
The goal of gardenr is provide simple functions of analyzing the data from Gardener's interneuron classification as well as to provide examples of analyses of such data.

## Installation
You can use the `devtools` package to install `garnenr` from Github. 
```{r, eval = FALSE}
devtools::install_github('ComputationalIntelligenceGroup/gardenr')
``` 

The user needs to provide the path to the folder containing the data. These can be downloaded from ...(TODO)
```{r}
folder <- '/home/bmihaljevic/code-gardener/gardener-experiment-data/data/' 
library(tidyverse)
```

## Usage
`garnenr` functions return the data for all 320 cells. There are functions for the classification labels `get_all_labels`, metadata `get_all_meta`, and alternative type names and definitions `get_alternative_types`.
```{r example}
library(gardenr)
annotations <- get_all_labels(folder ) 
summary(annotations)
``` 

```{r}
alternative <- get_alternative_types(folder)
summary(alternative)
```

```{r}
metadata <- get_all_meta(folder)
summary(metadata)
``` 

To get data on a specific cell or annotator, we only need filter by id:
```{r}
metadata %>% filter(neuron == 12)
annotations %>% filter(neuron == 12)
```

```{r} 
annotations %>% filter(annotator == 2)
alternative %>% filter(annotator == 2)
``` 



It is easy to combine the three data frames using joins, and then compute summaries with `tidyverse` functions. 
```{r}
other <- droplevels(subset(annotations, F5 == 'other'))
a <- levels(other$other) 
b <- levels(alternative$type)
setdiff(a, b)
setdiff(b, a)
library(tidyverse)
other <- left_join(other, alternative, by = c("other" = "type"))
length(unique(other$annotator)) 
```   
 
There is a utility function to return the counts for all categories, with a single entry per neuron.
```{r}
counts <- get_all_counts(folder) 
head(counts)
```

This is also available in row-view, which is a bit easier to analyze
```{r}

```


# Examples 

- Those which are other, and have this
- How many partially labelled cells?
- ... 
- Directly filter by confidence in some variable. Here, use the row verions. 
- Statistics for a species
   - we join, then filter

- 27 out of 48 neuroscientists provided alternative type names for the cells
```{r}
alternative <- get_alternative_types(folder)
head(alternative)
length(unique(alternative$annotator))
unique(alternative$annotator)
```
